<h2 id="general-info" class="section-header" padding>Vytvorenie nového modelu</h2>

<div *ngIf="serverError" class="alert alert-danger mt-3" role="alert" flex align-items-center>
  <div class="icon-wrapper danger" margin-right>
    <i class="far fa-times-circle"></i>
  </div>
  Nepodarilo sa pripojiť k serveru.
</div>


<div *ngIf="!serverError">
  <mat-form-field>
    <mat-label>Názov modelu: </mat-label>
    <input matInput type="text" placeholder="" [formControl]="name_of_model" [(ngModel)]="this.selected_name" />
    <mat-error *ngIf="name_of_model.invalid">Meno je povinný údaj</mat-error>
  </mat-form-field>
  <div class="row">
    <div class="col">
    
      <p>Vyberte obdobia, na ktorých sa bude model trénovať:</p>
      <button mat-raised-button class="btn-block" color="secondary" (click)="selectAllYears()">Vybrať všetky</button>

      <mat-selection-list #list_years [(ngModel)]="selectedYears" [ngModelOptions]="{standalone: true}">
        <mat-list-option *ngFor="let year of available_years" [value]="year" [checkboxPosition]="before">
          {{year}}
        </mat-list-option>
      </mat-selection-list>
      <span class="text-muted">Zobrazujú sa školské roky, pre ktoré sú importované známky.</span>
    </div>
    <div class="col">
        <p>Vyberte dáta, ktoré sa majú použiť na trénovanie modelu:</p>
      <button mat-raised-button class="btn-block" color="secondary" (click)="selectAllTables()">Vybrať všetky</button>

      <mat-selection-list #list_tables [(ngModel)]="selectedTables" [ngModelOptions]="{standalone: true}">
        <mat-list-option *ngFor="let table of available_tables" [value]="table" [checkboxPosition]="before">
          {{map.get(table)}}
        </mat-list-option>
      </mat-selection-list>
      <span class="text-muted">Zobrazujú sa tabuľky, v ktorých sú importované dáta.</span>
      <br>
      <span *ngIf="available_tables.indexOf('entry_tests') !== -1" class="text-muted">POZOR! Vstupné testy máte
        importované iba pre roky: {{ entry_tests_years }} </span>
    </div>
    <div class="col">
      <p>Vyberte predmet, pre ktorý chcete vytvoriť model.</p>
      <span class="text-muted">Ak chcete vytvoriť model celkovej predikcie, vyberte možnosť <strong>Celková
          predikcia</strong></span>
      <mat-form-field>
        <mat-label>Predmet: </mat-label>
        <mat-select [formControl]="subjects">
          <mat-option *ngFor="let subject of all_subjects" [value]="subject">
            {{ subject }}
          </mat-option>
        </mat-select>
      </mat-form-field>

      <div flex flex-column margin-top>
        <div *ngIf="dataService.showErrorMessage" class="alert alert-danger mt-3" role="alert" flex align-items-center>
          <div class="icon-wrapper danger" margin-right>
            <i class="far fa-times-circle"></i>
          </div>
          Pri vytváraní modelu sa vyskytla chyba. {{dataService.ErrorMessage}}
        </div>

        <div *ngIf="dataService.showSuccessMessage" class="alert alert-success mt-3" role="alert" flex
          align-items-center>
          <div class="icon-wrapper success" margin-right>
            <i class="far fa-check-circle"></i>
          </div>
          Model bol úspešne vytvorený.
        </div>

        <div *ngIf="dataService.loading" flex flex-column align-items-center>
          <mat-spinner></mat-spinner>
          <h4>Prebieha vytváranie modelu, počkajte prosím.</h4>
        </div>
      </div>
    </div>

  </div>
  <button mat-raised-button [disabled]="selectedYears.length == 0 || selectedTables.length == 0 || name_of_model.value == '' || subjects.value == ''" color="primary" (click)="onSubmit()">Spustiť trénovanie modelu</button>

</div>